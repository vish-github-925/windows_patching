---
- name: Master Pre Patch Activities
  hosts: windows
  gather_facts: true
  ignore_errors: true

  tasks:
        
  - name: Send pre patch activity starting mail
    mail:
     host: smpt.gmail.com
     port: 587
     username: vishnuvardhanuppunuthula@gmail.com
     password: GooglePass@925
     to: Sarika <sarikamarathe25@gmail.com> 
     subject: Pre-patch is going to start
     body: '''Hello team!!
     Pre-patch of windows servers is going to start!!

     Thanks and regards,
     '''
     #from: vishuvardhanuppunuthula@gmail.com 
     #to: Sarika <sarikamarathe25@gmail.com>
     #cc: Vishnuvardhan <vishnuvardhanuppunuthula@gmail.com>

                                                                                     # attach: /etc/group /tmp/pavatar2.png
                                                          #           headers: 'Reply-To=john@example.com|X-Special="Something or other"'
                                                          #charset: utf8
    delegate_to: localhost
                                                                                                                                              #
                                                                                                      #
  - name: Create a file to capture all pre-patch output
    ansible.windows.win_file:
           path: C:\Temp\pre_patch.txt
           state: touch

  - include_tasks: pre_patch.yaml
           
    #  - name: Send mail Pre patch activity report to team
                                                                                                                                              #                                                           mail:
                                                                                                                                              #                                                                     host: 127.0.0.1
                                                                                                                                              #                                                                               port: 2025
                                                                                                                                              #                                                                                         subject: Windows patching pre-patch report
                                                                                                                                              #                                                                                                   body: '''Hello team,
                                                                                                                                              #                                                                                                             
                                                                                                                                              #                                                                                                                       Please find the attachment and review the pre-patch activity report
                                                                                                                                              #                                                                                                                                 
                                                                                                                                              #                                                                                                                                           Thanks and regards
                                                                                                                                              #                                                                                                                                                     
                                                                                                                                              #                                                                                                                                                               '''
                                                                                                                                              #                                                                                                                                                                         from: jane@example.net (Jane Jolie)
                                                                                                                                              #                                                                                                                                                                                   to: John Doe <j.d@example.org>, Suzie Something <sue@example.com>
                                                                                                                                              #                                                                                                                                                                                             cc: Charlie Root <root@localhost>
                                                                                                                                              #                                                                                                                                                                                                       attach:  C:\Temp\pre_patch.txt
                                                                                                                                              #                                                                                                                                                                                                                 headers: 'Reply-To=john@example.com|X-Special="Something or other"'
                                                                                                                                              #                                                                                                                                                                                                                           charset: utf8
                                                                                                                                              #                                                                                                                                                                                                                                 delegate_to: localhost
                                                                                                                                              #                                                                                                                                                                                                                                      
